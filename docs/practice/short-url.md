如何实现一个短网址系统
## 需求分析

### 输入
一个长网址, 支持过期时间以及自定义的别名。

### 输出
自定义别名或者随机生成的短域名,在过期时间到来前访问都可以被重定向到原始的长网址上

### 要求
1. 过期后将失效
2. 短域名是唯一的
3. 支持自定义短域名,长度在7个字符(不含域名长度),由[0-9,a-z,A-Z]等字符组成
4. QPS 
    1. 写 DAU = 100M  -> QPS = 100M * 0.1/ 86400 = 1K -> 峰值 2k -> 预估值 = 4K
    2. 读 DAU = 100M  -> QPS = 100M * 10 / 86400 = 115k -> 峰值230k-> 预估值460k
    3. 这是一个读多写少的系统
5. 延迟 = 10ms以内
6. 存储 = 128+7 = 100 bytes/条 * 1500 * 60 * 60 * 24 * 365 = 20T/年
7. 可靠性: 5个9
8. 安全性: 防止被人爬取,盗用数据

## 系统设计

### 如何通过hash算法生成短网址

我们并不需要熟知的sha和md5等hash算法。我们不需要考虑被反向解密的后果，我们更应该更应该关注于算法效率以及减少hash冲突的概率。

[MurmurHash算法](https://zh.wikipedia.org/wiki/Murmur%E5%93%88%E5%B8%8C)是一个可以满足的需求的算法，已经被广泛应用于各种知名软件中。

### 过期时间设计
由于我们可以存储长网址和短网址的映射关系到Redis里，我们可以直接使用Redis的过期策略就好。

我们也可以存储一份数据到Mysql里，此时记录过期时间。